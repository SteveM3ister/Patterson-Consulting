setwd("C:/Desktop/MSSP/MA676/Patterson Consulting")
source('C:/Desktop/MSSP/MA676/Patterson Consulting/Patterson.R', echo=TRUE)
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load("tidyverse","xlsx","magrittr")
ggplot(data = survey_data) + geom_bar(aes(Age))
ggplot(data = survey_data) + geom_bar(aes(Size))
ggplot(data = survey_data) + geom_bar(aes(Frequency))
ggplot(data = survey_data) + geom_bar(aes(Frequency, fill = Age))
ggplot(data = survey_data) + geom_bar(aes(Frequency, fill = Size))
ggplot(data = survey_data) + geom_bar(aes(Frequency, fill = Age)) + facet_wrap(vars(Size))
colnames[31:38]
colnames(survey_data)[31:38]
colnames(survey_data)[39:46]
priority<-gather(survey_data,"Q21.11 Rank Awareness" ,      "Q21.12 Rank Fam Edu",         "Q21.13 Rank Provider Edu"  ,  "Q21.14 Rank Support Fam" ,    "Q21.15 Rank Resource" ,       "Q21.16 Rank Research",key="Field",value="Rank")
View(priority)
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load("tidyverse","xlsx","magrittr","tidyr")
colnames(priority)
View(survey_data)
priority%<>%select("Q4 Organization Name" , "Frequency" , "Size","Age"  ,  "Field"  ,  "Rank")
View(priority)
?arrange()
priority<-priority[!is.na(priority)]
priority<-priority[!is.na(priority),]
priority<-priority[!is.na(priority$Rank),]
priority%>%group_by(Frequency,Size,Age,Field)%>%summarise(meanrank=mean(Rank))%>%
arrange(desc(meanrank))
priority%>%group_by(Frequency,Size,Age,Field)%>%summarise(meanrank=mean(Rank))%>%
arrange(desc(meanrank))->priorityrank
View(priorityrank)
priority%>%group_by(Frequency,Field)%>%summarise(meanrank=mean(Rank))%>%
arrange(desc(meanrank))->priorityrank
names(priorityrank)
ggplot(data=priorityrank,aes(x=Field,y=meanrank,col=Frequency))+geom_histogram(stat="identity")
ggplot(data=priorityrank,aes(x=Field,y=meanrank,fill=Frequency))+geom_histogram(stat="identity")
priorityrank%>%separate(Field,c("Question","Rank","Field"),sep=" ")
View(priorityrank)
priorityrank%<>%separate(Field,c("Question","Rank","Field"),sep=" ")
priorityrank%<>%select(-c("Question","Rank"))
ggplot(data=priorityrank,aes(x=Field,y=meanrank,fill=Frequency))+geom_histogram(stat="identity")
ggplot(data=priorityrank,aes(x=Field,y=meanrank,fill=Frequency))+geom_point()
ggplot(data=priorityrank,aes(x=Field,y=meanrank,col=Frequency))+geom_point()
priority%>%group_by(Size,Field)%>%summarise(meanrank=mean(Rank))%>%
arrange(desc(meanrank))->priorityrank2
priorityrank%<>%separate(Field,c("Question","Rank","Field"),sep=" ")
priorityrank%<>%select(-c("Question","Rank"))
ggplot(data=priorityrank,aes(x=Field,y=meanrank,col=Size))+geom_point()
View(priorityrank2)
priority%>%group_by(Frequency,Field)%>%summarise(meanrank=mean(Rank))%>%
arrange(desc(meanrank))->priorityrank
priorityrank%<>%separate(Field,c("Question","Rank","Field"),sep=" ")
priorityrank%<>%select(-c("Question","Rank"))
ggplot(data=priorityrank,aes(x=Field,y=meanrank,col=Frequency))+geom_point()
priority%>%group_by(Size,Field)%>%summarise(meanrank=mean(Rank))%>%
arrange(desc(meanrank))->priorityrank2
priorityrank2%<>%separate(Field,c("Question","Rank","Field"),sep=" ")
priorityrank2%<>%select(-c("Question","Rank"))
ggplot(data=priorityrank2,aes(x=Field,y=meanrank,col=Size))+geom_point()
priority%>%group_by(Frequency,Field)%>%summarise(meanrank=mean(Rank))%>%
arrange(desc(meanrank))->priorityrank
priorityrank%<>%separate(Field,c("Question","Rank","Field"),sep=" ")
priorityrank%<>%select(-c("Question","Rank"))
ggplot(data=priorityrank,aes(x=Field,y=meanrank,col=Frequency))+geom_point()+title("Mean  rank over Frequency")
ggplot(data=priorityrank,aes(x=Field,y=meanrank,col=Frequency))+geom_point()+ggtitle("Mean  rank over Frequency")
priority%>%group_by(Size,Field)%>%summarise(meanrank=mean(Rank))%>%
arrange(desc(meanrank))->priorityrank2
priorityrank2%<>%separate(Field,c("Question","Rank","Field"),sep=" ")
priorityrank2%<>%select(-c("Question","Rank"))
ggplot(data=priorityrank2,aes(x=Field,y=meanrank,col=Size))+geom_point()+ggtitle("Mean  rank over Size")
priority%>%group_by(Age,Field)%>%summarise(meanrank=mean(Rank))%>%
arrange(desc(meanrank))->priorityrank3
priorityrank3%<>%separate(Field,c("Question","Rank","Field"),sep=" ")
priorityrank3%<>%select(-c("Question","Rank"))
ggplot(data=priorityrank3,aes(x=Field,y=meanrank,col=Size))+geom_point()+ggtitle("Mean  rank over Age")
priority%>%group_by(Age,Field)%>%summarise(meanrank=mean(Rank))%>%
arrange(desc(meanrank))->priorityrank3
priorityrank3%<>%separate(Field,c("Question","Rank","Field"),sep=" ")
priorityrank3%<>%select(-c("Question","Rank"))
ggplot(data=priorityrank3,aes(x=Field,y=meanrank,col=Age))+geom_point()+ggtitle("Mean  rank over Age")
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load("tidyverse","xlsx","magrittr","tidyr")
survey_data <- read_excel("Patterson_Capstone_Data_Cat_Num_031021.xls")
survey_data <- read.xlsx("Patterson_Capstone_Data_Cat_Num_031021.xls")
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load("tidyverse","xlsx","magrittr","tidyr","readxl")
survey_data <- read.xls("Patterson_Capstone_Data_Cat_Num_031021.xls")
survey_data <- read_excel("Patterson_Capstone_Data_Cat_Num_031021.xls")
View(survey_data)
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load("tidyverse","xlsx","magrittr","tidyr","readxl")
## Bucketing independent variables
survey_data$Frequency <- ifelse(survey_data$`Q6 Birth Frequency`=="More common than 1 in 2,000 births", "rare",
ifelse(survey_data$`Q6 Birth Frequency`=="1 in 2,000-50,000 births", "rare",
ifelse(survey_data$`Q6 Birth Frequency`=="1 in 50,000-200,000 births", "rare",
ifelse(survey_data$`Q6 Birth Frequency`=="1 in 200,000-500,000 births", "ultra-rare",
ifelse(survey_data$`Q6 Birth Frequency`=="1 in 500,000-1,000,000 births", "ultra-rare",
ifelse(survey_data$`Q6 Birth Frequency`=="Fewer than 1 in 1,000,000 births", "ultra-rare",
survey_data$`Q6 Birth Frequency`))))))
survey_data$Size <- ifelse(survey_data$`Q10 Size (#Members)`=="Fewer than 60", "small",
ifelse(survey_data$`Q10 Size (#Members)`=="60-300", "small",
ifelse(survey_data$`Q10 Size (#Members)`=="300-1,000", "medium",
ifelse(survey_data$`Q10 Size (#Members)`=="1,000-10,000", "large",
ifelse(survey_data$`Q10 Size (#Members)`=="More than 10,000", "large",
survey_data$`Q10 Size (#Members)`)))))
survey_data$Age <- ifelse(survey_data$`Q9 Age`=="Less than 5 years ago", "younger",
ifelse(survey_data$`Q9 Age`=="5-10 years ago", "younger",
ifelse(survey_data$`Q9 Age`=="10-15 years ago", "older",
ifelse(survey_data$`Q9 Age`=="15+ years ago", "older",
survey_data$`Q9 Age`))))
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load("tidyverse","xlsx","magrittr","tidyr","readxl")
survey_data <- read_excel("Patterson_Capstone_Data_Cat_Num_031021.xls")
View(survey_data)
## Bucketing independent variables
survey_data$Frequency <- ifelse(survey_data$`Q6 Birth Frequency`=="More common than 1 in 2,000 births", "rare",
ifelse(survey_data$`Q6 Birth Frequency`=="1 in 2,000-50,000 births", "rare",
ifelse(survey_data$`Q6 Birth Frequency`=="1 in 50,000-200,000 births", "rare",
ifelse(survey_data$`Q6 Birth Frequency`=="1 in 200,000-500,000 births", "ultra-rare",
ifelse(survey_data$`Q6 Birth Frequency`=="1 in 500,000-1,000,000 births", "ultra-rare",
ifelse(survey_data$`Q6 Birth Frequency`=="Fewer than 1 in 1,000,000 births", "ultra-rare",
survey_data$`Q6 Birth Frequency`))))))
survey_data$Size <- ifelse(survey_data$`Q10 Size (#Members)`=="Fewer than 60", "small",
ifelse(survey_data$`Q10 Size (#Members)`=="60-300", "small",
ifelse(survey_data$`Q10 Size (#Members)`=="300-1,000", "medium",
ifelse(survey_data$`Q10 Size (#Members)`=="1,000-10,000", "large",
ifelse(survey_data$`Q10 Size (#Members)`=="More than 10,000", "large",
survey_data$`Q10 Size (#Members)`)))))
survey_data$Age <- ifelse(survey_data$`Q9 Age`=="Less than 5 years ago", "younger",
ifelse(survey_data$`Q9 Age`=="5-10 years ago", "younger",
ifelse(survey_data$`Q9 Age`=="10-15 years ago", "older",
ifelse(survey_data$`Q9 Age`=="15+ years ago", "older",
survey_data$`Q9 Age`))))
priority<-gather(survey_data,"Q21.11 Rank Awareness" ,      "Q21.12 Rank Fam Edu",         "Q21.13 Rank Provider Edu"  ,  "Q21.14 Rank Support Fam" ,    "Q21.15 Rank Resource" ,       "Q21.16 Rank Research",key="Field",value="Rank")
priority%<>%select("Q4 Organization Name" , "Frequency" , "Size","Age"  ,  "Field"  ,  "Rank")
priority<-priority[!is.na(priority$Rank),]
priority%>%group_by(Frequency,Field)%>%summarise(meanrank=mean(Rank))%>%
arrange(desc(meanrank))->priorityrank
priorityrank%<>%separate(Field,c("Question","Rank","Field"),sep=" ")
priorityrank%<>%select(-c("Question","Rank"))
ggplot(data=priorityrank,aes(x=Field,y=meanrank,col=Frequency))+geom_point()+ggtitle("Mean  rank over Frequency")
priority%>%group_by(Size,Field)%>%summarise(meanrank=mean(Rank))%>%
arrange(desc(meanrank))->priorityrank2
priorityrank2%<>%separate(Field,c("Question","Rank","Field"),sep=" ")
priorityrank2%<>%select(-c("Question","Rank"))
ggplot(data=priorityrank2,aes(x=Field,y=meanrank,col=Size))+geom_point()+ggtitle("Mean  rank over Size")
priority%>%group_by(Age,Field)%>%summarise(meanrank=mean(Rank))%>%
arrange(desc(meanrank))->priorityrank3
priorityrank3%<>%separate(Field,c("Question","Rank","Field"),sep=" ")
priorityrank3%<>%select(-c("Question","Rank"))
ggplot(data=priorityrank3,aes(x=Field,y=meanrank,col=Age))+geom_point()+ggtitle("Mean  rank over Age")
View(priority)
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load("tidyverse","xlsx","magrittr","tidyr","readxl")
ggplot(data=priority,aes(x=Field,y=Rank,col=Frequency))+geom_boxplot()+ggtitle("Mean  rank over Frequency")+theme(text = element_text(size=15),
axis.text.x = element_text(angle=45, hjust=1))
?geom_errorbar
View(priorityrank)
priority%>%group_by(Frequency,Field)%>%summarise(meanrank=mean(Rank),lower=meanrank-sd(Rank)/sqrt(n()))%>%
arrange(desc(meanrank))->priorityrank
rownames(priorityrank)!="Unknown"
priorityrank%<>%subset(Frequency!=c("Unknown",NA))
priority%>%group_by(Frequency,Field)%>%summarise(meanrank=mean(Rank),lower=meanrank-sd(Rank)/sqrt(n()),upper=lower=meanrank+sd(Rank)/sqrt(n()))%>%
priority%>%group_by(Frequency,Field)%>%summarise(meanrank=mean(Rank),lower=meanrank-sd(Rank)/sqrt(n()),upper=meanrank+sd(Rank)/sqrt(n()))%>%
arrange(desc(meanrank))->priorityrank
priorityrank%<>%separate(Field,c("Question","Rank","Field"),sep=" ")
priorityrank%<>%select(-c("Question","Rank"))
priorityrank%<>%subset(Frequency!="Unknown")
ggplot(data=priorityrank,aes(x=Field,y=meanrank,col=Frequency))+geom_point()+geom_pointrange(aes(ymin=lower,ymax=upper))+ggtitle("Mean  rank over Frequency")+theme(text = element_text(size=15),
axis.text.x = element_text(angle=45, hjust=1))
priority%>%group_by(Size,Field)%>%summarise(meanrank=mean(Rank),lower=meanrank-sd(Rank)/sqrt(n()),upper=meanrank+sd(Rank)/sqrt(n()))%>%
arrange(desc(meanrank))->priorityrank2
priorityrank2%<>%separate(Field,c("Question","Rank","Field"),sep=" ")
priorityrank2%<>%select(-c("Question","Rank"))
priorityrank%<>%subset(Frequency!="Unknown")
ggplot(data=priorityrank2,aes(x=Field,y=meanrank,col=Size))+geom_point()+geom_pointrange(aes(ymin=lower,ymax=upper))+ggtitle("Mean  rank over Size")+theme(text = element_text(size=15),
axis.text.x = element_text(angle=45, hjust=1))
priority%>%group_by(Size,Field)%>%summarise(meanrank=mean(Rank),lower=meanrank-sd(Rank)/sqrt(n()),upper=meanrank+sd(Rank)/sqrt(n()))%>%
arrange(desc(meanrank))->priorityrank2
priorityrank2%<>%separate(Field,c("Question","Rank","Field"),sep=" ")
priorityrank2%<>%select(-c("Question","Rank"))
priorityrank%<>%subset(Size!="Unknown")
priority%>%group_by(Size,Field)%>%summarise(meanrank=mean(Rank),lower=meanrank-sd(Rank)/sqrt(n()),upper=meanrank+sd(Rank)/sqrt(n()))%>%
arrange(desc(meanrank))->priorityrank2
priorityrank2%<>%separate(Field,c("Question","Rank","Field"),sep=" ")
priorityrank2%<>%select(-c("Question","Rank"))
priorityrank2%<>%subset(Size!="Unknown")
ggplot(data=priorityrank2,aes(x=Field,y=meanrank,col=Size))+geom_point()+geom_pointrange(aes(ymin=lower,ymax=upper))+ggtitle("Mean  rank over Size")+theme(text = element_text(size=15),
axis.text.x = element_text(angle=45, hjust=1))
priority%>%group_by(Age,Field)%>%summarise(meanrank=mean(Rank),lower=meanrank-sd(Rank)/sqrt(n()),upper=meanrank+sd(Rank)/sqrt(n()))%>%
arrange(desc(meanrank))->priorityrank3
priorityrank3%<>%separate(Field,c("Question","Rank","Field"),sep=" ")
priorityrank3%<>%select(-c("Question","Rank"))
ggplot(data=priorityrank3,aes(x=Field,y=meanrank,col=Age))+geom_point()+geom_pointrange(aes(ymin=lower,ymax=upper))+ggtitle("Mean  rank over Age")+theme(text = element_text(size=15),
axis.text.x = element_text(angle=45, hjust=1))
pacman::p_load("tidyverse","xlsx","magrittr","tidyr","readxl","polr")
pacman::p_load("tidyverse","xlsx","magrittr","tidyr","readxl","rstanarm")
View(priority)
View(survey_data)
View(priority)
survey_data%>%select("Q4 Organization Name" , "Frequency" , "Size","Age" ,c(31:46))->prior_bi
View(prior_bi)
prior_bi[1,5:12]=="Extermely important"
prior_bi[1,5:12]=="Extremely important"
ifelse(prior_bi[1,5:12]=="Extremely important",0,1)
ifelse(prior_bi[1,5:12]=="Extremely important",1,0)
paste(ifelse(prior_bi[1,5:12]=="Extremely important",1,0))
paste0(ifelse(prior_bi[1,5:12]=="Extremely important",1,0))
interaction(ifelse(prior_bi[1,5:12]=="Extremely important",1,0),sep="")
paste0(ifelse(prior_bi[1,5:12]=="Extremely important",1,0),sep="")
paste0(ifelse(prior_bi[1,5:12]=="Extremely important",1,0),sep="")%>%class()
paste0(ifelse(prior_bi[1,5:12]=="Extremely important",1,0),collapse="")
prior_bi["bi_code"]<-paste0(ifelse(prior_bi[,5:12]=="Extremely important",1,0),collapse="")
?sapply
prior_bi["bi_code"]<-sapply(prior_bi,2,paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse=""))
?apply
prior_bi["bi_code"]<-apply(prior_bi,2,paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse=""))
prior_bi["bi_code"]<-apply(prior_bi,2,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse=""))
prior_bi["bi_code"]<-apply(prior_bi,1,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse=""))
View(prior_bi)
prior_bi[is.na(prior_bi)]<-0
survey_data%>%select("Q4 Organization Name" , "Frequency" , "Size","Age" ,c(31:46))->prior_bi
prior_bi[is.na(prior_bi)]<-0
prior_bi[is.na(prior_bi[,5:20])]<-0
prior_bi[is.na(prior_bi[,5:20]),5:20]<-0
prior_bi%>%is.na()->naindex
View(naindex)
survey_data%>%select("Q4 Organization Name" , "Frequency" , "Size","Age" ,c(31:46))->prior_bi
prior_bi$`Q4 Organization Name`[is.nae(prior_bi$`Q4 Organization Name`)]<-"Anonymous"
prior_bi$`Q4 Organization Name`[is.na(prior_bi$`Q4 Organization Name`)]<-"Anonymous"
prior_bi[is.na(prior_bi)]<-0
prior_bi[,5:20][is.nae(prior_bi[,5:20])]<-0
prior_bi[,5:20][is.na(prior_bi[,5:20])]<-0
prior_bi[,13:20][is.na(prior_bi[,13:20])]<-0
prior_bi[,5:12][is.na(prior_bi[,5:12])]<-"NA"
prior_bi["bi_code"]<-apply(prior_bi,1,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse=""))
prior_bi$bi_code<-ifelse(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]=="1",1,0),collapse=""))=="00000000",prior_bi$code,apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]=="1",1,0),collapse="")))
prior_bi$bi_code<-ifelse(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))=="00000000",prior_bi$code,apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]=="1",1,0),collapse="")))
prior_bi$bi_code<-ifelse(apply(prior_bi[13:20],1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))=="00000000",prior_bi$code,apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]=="1",1,0),collapse="")))
survey_data%>%select("Q4 Organization Name" , "Frequency" , "Size","Age" ,c(31:46))->prior_bi
prior_bi$`Q4 Organization Name`[is.na(prior_bi$`Q4 Organization Name`)]<-"Anonymous"
prior_bi[,13:20][is.na(prior_bi[,13:20])]<-0
prior_bi[,5:12][is.na(prior_bi[,5:12])]<-"NA"
prior_bi["bi_code"]<-apply(prior_bi,1,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse=""))
?ifelse()
prior_bi$bi_code<-ifelse(apply(prior_bi[13:20],1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))=="00000000",prior_bi$bi_code,apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]=="1",1,0),collapse="")))
survey_data%>%select("Q4 Organization Name" , "Frequency" , "Size","Age" ,c(31:46))->prior_bi
prior_bi$`Q4 Organization Name`[is.na(prior_bi$`Q4 Organization Name`)]<-"Anonymous"
prior_bi[,13:20][is.na(prior_bi[,13:20])]<-0
prior_bi[,5:12][is.na(prior_bi[,5:12])]<-"NA"
prior_bi["bi_code"]<-apply(prior_bi,1,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse=""))
prior_bi$bi_code<-ifelse(apply(prior_bi[13:20],1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000",prior_bi$bi_code,apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]=="1",1,0),collapse="")))
prior_bi$bi_code<-ifelse(apply(prior_bi[13:20],1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))=="00000000",prior_bi$bi_code,apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse="")))
survey_data%>%select("Q4 Organization Name" , "Frequency" , "Size","Age" ,c(31:46))->prior_bi
prior_bi$`Q4 Organization Name`[is.na(prior_bi$`Q4 Organization Name`)]<-"Anonymous"
prior_bi[,13:20][is.na(prior_bi[,13:20])]<-0
prior_bi[,5:12][is.na(prior_bi[,5:12])]<-"NA"
prior_bi["bi_code"]<-apply(prior_bi,1,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse=""))
prior_bi$bi_code<-ifelse(apply(prior_bi[13:20],1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000",prior_bi$bi_code,apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse="")))
apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))
apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))=="00000000"
prior_bi$bi_code<-ifelse(apply(prior_bi[13:20],1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000",prior_bi[,21],apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse="")))
survey_data%>%select("Q4 Organization Name" , "Frequency" , "Size","Age" ,c(31:46))->prior_bi
prior_bi$`Q4 Organization Name`[is.na(prior_bi$`Q4 Organization Name`)]<-"Anonymous"
prior_bi[,13:20][is.na(prior_bi[,13:20])]<-0
prior_bi[,5:12][is.na(prior_bi[,5:12])]<-"NA"
prior_bi["bi_code"]<-apply(prior_bi,1,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse=""))
prior_bi$bi_code<-ifelse(apply(prior_bi[13:20],1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000",x[,21],apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse="")))
prior_bi$bi_code<-ifelse(apply(prior_bi[13:20],1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000",apply(prior_bi,1,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse="")),apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse="")))
survey_data%>%select("Q4 Organization Name" , "Frequency" , "Size","Age" ,c(31:46))->prior_bi
prior_bi$`Q4 Organization Name`[is.na(prior_bi$`Q4 Organization Name`)]<-"Anonymous"
prior_bi[,13:20][is.na(prior_bi[,13:20])]<-0
prior_bi[,5:12][is.na(prior_bi[,5:12])]<-"NA"
prior_bi["bi_code"]<-apply(prior_bi,1,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse=""))
prior_bi$bi_code<-ifelse(apply(prior_bi[13:20],1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))=="00000000",apply(prior_bi,1,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse="")),apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse="")))
apply(prior_bi[13:20],1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))=="00000000"
apply(prior_bi[13:20],1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))
apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))
apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))=="00000000"
prior_bi$bi_code<-ifelse(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))=="00000000",apply(prior_bi,1,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse="")),apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse="")))
survey_data%>%select("Q4 Organization Name" , "Frequency" , "Size","Age" ,c(31:46))->prior_bi
prior_bi$`Q4 Organization Name`[is.na(prior_bi$`Q4 Organization Name`)]<-"Anonymous"
prior_bi[,13:20][is.na(prior_bi[,13:20])]<-0
prior_bi[,5:12][is.na(prior_bi[,5:12])]<-"NA"
prior_bi$bi_code<-ifelse(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))=="00000000",apply(prior_bi,1,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse="")),apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse="")))
prior_bi[-which(prior_bi$bi_code=="00000000"),]
which(prior_bi$bi_code=="00000000")
View(prior_bi)
prior_bi<-prior_bi[-which(prior_bi$bi_code=="00000000"),]
View(prior_bi)
?strtoi()
strtoi(c("0xff", "077", "123"))
strtoi(c("1001", "011", "11"))
strtoi(c("1001", "011", "11"),2L)
prior_bi["de_code"]<-strtoi(prior_bi$bi_code)
prior_bi["de_code"]<-strtoi(prior_bi$bi_code,2L)
unique(prior_bi$de_code)
unique(prior_bi$de_code)%>%length()
nrow(prior_bi)
haverank<-prior_bi[which(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000"),]
View(haverank)
norank<-prior_bi[!which(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000"),]
norank<-prior_bi[-which(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000"),]
?cbind()
haverank<-prior_bi[which(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000"),]
norank<-prior_bi[-which(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000"),]
norank_1<-norank[which(norank$`Q21.1 Rate Awareness`=="Extremely important"),]
norank_1[,6:12]<-"NA"
norank_2<-norank[which(norank$`Q21.2 Rate Fam Edu`=="Extremely important"),]
norank_2[,c(5,7:12)]<-"NA"
norank_3<-norank[which(norank$`Q21.3 Rate Provider Edu`=="Extremely important"),]
norank_3[,c(5,6,8:12)]<-"NA"
norank_4<-norank[which(norank$`Q21.4 Rate Support Fam`=="Extremely important"),]
norank_4[,c(5:7,9:12)]<-"NA"
norank_5<-norank[which(norank$`Q21.5 Rate Fam Resource`=="Extremely important"),]
norank_5[,c(5:8,10:12)]<-"NA"
norank_6<-norank[which(norank$`Q21.6 Rate Research`=="Extremely important"),]
norank_6[,c(5:9,11:12)]<-"NA"
norank_7<-norank[which(norank$`Q21.7 Rate Research Policy`=="Extremely important"),]
norank_7[,c(5:10,12)]<-"NA"
norank_8<-norank[which(norank$`Q21.8 Rate Advocacy`=="Extremely important"),]
norank_8[,5:11]<-"NA"
rbind(norank_1,norank_2,norank_3,norank_4,norank_5,norank_6,norank_7,norank_8)->norank_final
View(norank_final)
rbind(norank_1,norank_2,norank_3,norank_4,norank_5,norank_6,norank_7,norank_8,haverank)->rank_final
View(rank_final)
survey_data%>%select("Q4 Organization Name" , "Frequency" , "Size","Age" ,c(31:46))->prior_bi
prior_bi$`Q4 Organization Name`[is.na(prior_bi$`Q4 Organization Name`)]<-"Anonymous"
prior_bi[,13:20][is.na(prior_bi[,13:20])]<-0
prior_bi[,5:12][is.na(prior_bi[,5:12])]<-"NA"
haverank<-prior_bi[which(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000"),]
norank<-prior_bi[-which(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000"),]
norank_1<-norank[which(norank$`Q21.1 Rate Awareness`=="Extremely important"),]
norank_1[,6:12]<-"NA"
norank_2<-norank[which(norank$`Q21.2 Rate Fam Edu`=="Extremely important"),]
norank_2[,c(5,7:12)]<-"NA"
norank_3<-norank[which(norank$`Q21.3 Rate Provider Edu`=="Extremely important"),]
norank_3[,c(5,6,8:12)]<-"NA"
norank_4<-norank[which(norank$`Q21.4 Rate Support Fam`=="Extremely important"),]
norank_4[,c(5:7,9:12)]<-"NA"
norank_5<-norank[which(norank$`Q21.5 Rate Fam Resource`=="Extremely important"),]
norank_5[,c(5:8,10:12)]<-"NA"
norank_6<-norank[which(norank$`Q21.6 Rate Research`=="Extremely important"),]
norank_6[,c(5:9,11:12)]<-"NA"
norank_7<-norank[which(norank$`Q21.7 Rate Research Policy`=="Extremely important"),]
norank_7[,c(5:10,12)]<-"NA"
norank_8<-norank[which(norank$`Q21.8 Rate Advocacy`=="Extremely important"),]
norank_8[,5:11]<-"NA"
rbind(norank_1,norank_2,norank_3,norank_4,norank_5,norank_6,norank_7,norank_8,haverank)->rank_final
rank_final["bicode"]<-ifelse(apply(rank_final,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))=="00000000",apply(rank_final,1,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse="")),apply(rank_final,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse="")))
View(rank_final)
rank_final["de_code"]<-strtoi(rank_final$bi_code,2L)
rank_final["de_code"]<-strtoi(rank_final$bicode,2L)
unique(rank_final$de_code)
haverank<-prior_bi[which(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000"),]
norank<-prior_bi[-which(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000"),]
norank_1<-norank[which(norank$`Q21.1 Rate Awareness`=="Extremely important"),]
norank_1[,6:12]<-"NA"
norank_2<-norank[which(norank$`Q21.2 Rate Fam Edu`=="Extremely important"),]
norank_2[,c(5,7:12)]<-"NA"
norank_3<-norank[which(norank$`Q21.3 Rate Provider Edu`=="Extremely important"),]
norank_3[,c(5,6,8:12)]<-"NA"
norank_4<-norank[which(norank$`Q21.4 Rate Support Fam`=="Extremely important"),]
norank_4[,c(5:7,9:12)]<-"NA"
norank_5<-norank[which(norank$`Q21.5 Rate Fam Resource`=="Extremely important"),]
norank_5[,c(5:8,10:12)]<-"NA"
norank_6<-norank[which(norank$`Q21.6 Rate Research`=="Extremely important"),]
norank_6[,c(5:9,11:12)]<-"NA"
norank_7<-norank[which(norank$`Q21.7 Rate Research Policy`=="Extremely important"),]
norank_7[,c(5:10,12)]<-"NA"
norank_8<-norank[which(norank$`Q21.8 Rate Advocacy`=="Extremely important"),]
norank_8[,5:11]<-"NA"
rbind(norank_1,norank_2,norank_3,norank_4,norank_5,norank_6,norank_7,norank_8,haverank)->rank_final
haverank<-prior_bi[which(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000"),]
norank<-prior_bi[-which(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000"),]
norank_1<-norank[which(norank$`Q21.1 Rate Awareness`=="Extremely important"),]
norank_1[,6:12]<-"NA"
norank_2<-norank[which(norank$`Q21.2 Rate Fam Edu`=="Extremely important"),]
norank_2[,c(5,7:12)]<-"NA"
norank_3<-norank[which(norank$`Q21.3 Rate Provider Edu`=="Extremely important"),]
norank_3[,c(5,6,8:12)]<-"NA"
norank_4<-norank[which(norank$`Q21.4 Rate Support Fam`=="Extremely important"),]
norank_4[,c(5:7,9:12)]<-"NA"
norank_5<-norank[which(norank$`Q21.5 Rate Fam Resource`=="Extremely important"),]
norank_5[,c(5:8,10:12)]<-"NA"
norank_6<-norank[which(norank$`Q21.6 Rate Research`=="Extremely important"),]
norank_6[,c(5:9,11:12)]<-"NA"
norank_7<-norank[which(norank$`Q21.7 Rate Research Policy`=="Extremely important"),]
norank_7[,c(5:10,12)]<-"NA"
norank_8<-norank[which(norank$`Q21.8 Rate Advocacy`=="Extremely important"),]
norank_8[,5:11]<-"NA"
rbind(norank_1,norank_2,norank_3,norank_4,norank_5,norank_6,norank_7,norank_8,haverank)->rank_final
rank_final["bicode"]<-ifelse(apply(rank_final,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))=="00000000",apply(rank_final,1,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse="")),apply(rank_final,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse="")))
rank_final["de_code"]<-strtoi(rank_final$bicode,2L)
?switch()
rank_final["priority"]<-switch(rank_final$bicode,"100000000"="Awareness","01000000"="Fam Edu","00100000"="Provide Edu","00010000"="Support Fam","00001000"="Fam Resource","00000100"="Research","00000010"="Research Policy","00000001"="Advocacy")
rank_final["priority"]<-apply(rank_final,1,function(x) switch(x$bicode,"100000000"="Awareness","01000000"="Fam Edu","00100000"="Provide Edu","00010000"="Support Fam","00001000"="Fam Resource","00000100"="Research","00000010"="Research Policy","00000001"="Advocacy"))
rank_final["priority"]<-apply(rank_final,1,function(x) switch(x[21],"100000000"="Awareness","01000000"="Fam Edu","00100000"="Provide Edu","00010000"="Support Fam","00001000"="Fam Resource","00000100"="Research","00000010"="Research Policy","00000001"="Advocacy"))
apply(rank_final,1,function(x) switch(x[21],"100000000"="Awareness","01000000"="Fam Edu","00100000"="Provide Edu","00010000"="Support Fam","00001000"="Fam Resource","00000100"="Research","00000010"="Research Policy","00000001"="Advocacy"))
unique(rank_final$bicode)
apply(rank_final,1,function(x) switch(x[21],"10000000"="Awareness","01000000"="Fam Edu","00100000"="Provide Edu","00010000"="Support Fam","00001000"="Fam Resource","00000100"="Research","00000010"="Research Policy","00000001"="Advocacy"))
rank_final["priority"]<-apply(rank_final,1,function(x) switch(x[21],"10000000"="Awareness","01000000"="Fam Edu","00100000"="Provide Edu","00010000"="Support Fam","00001000"="Fam Resource","00000100"="Research","00000010"="Research Policy","00000001"="Advocacy"))
haverank<-prior_bi[which(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000"),]
norank<-prior_bi[-which(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000"),]
norank_1<-norank[which(norank$`Q21.1 Rate Awareness`=="Extremely important"),]
norank_1[,6:12]<-"NA"
norank_2<-norank[which(norank$`Q21.2 Rate Fam Edu`=="Extremely important"),]
norank_2[,c(5,7:12)]<-"NA"
norank_3<-norank[which(norank$`Q21.3 Rate Provider Edu`=="Extremely important"),]
norank_3[,c(5,6,8:12)]<-"NA"
norank_4<-norank[which(norank$`Q21.4 Rate Support Fam`=="Extremely important"),]
norank_4[,c(5:7,9:12)]<-"NA"
norank_5<-norank[which(norank$`Q21.5 Rate Fam Resource`=="Extremely important"),]
norank_5[,c(5:8,10:12)]<-"NA"
norank_6<-norank[which(norank$`Q21.6 Rate Research`=="Extremely important"),]
norank_6[,c(5:9,11:12)]<-"NA"
norank_7<-norank[which(norank$`Q21.7 Rate Research Policy`=="Extremely important"),]
norank_7[,c(5:10,12)]<-"NA"
norank_8<-norank[which(norank$`Q21.8 Rate Advocacy`=="Extremely important"),]
norank_8[,5:11]<-"NA"
rbind(norank_1,norank_2,norank_3,norank_4,norank_5,norank_6,norank_7,norank_8,haverank)->rank_final
rank_final["bicode"]<-ifelse(apply(rank_final,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))=="00000000",apply(rank_final,1,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse="")),apply(rank_final,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse="")))
rank_final["priority"]<-apply(rank_final,1,function(x) switch(x[21],"10000000"="Awareness","01000000"="Fam Edu","00100000"="Provide Edu","00010000"="Support Fam","00001000"="Fam Resource","00000100"="Research","00000010"="Research Policy","00000001"="Advocacy"))
m1<-stan_glm(priority~Age+Size+Frequency,family=binomial(link="logit"))
m1<-stan_glm(priority~Age+Size+Frequency,data=rank_final,family=binomial(link="logit"))
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load("tidyverse","xlsx","magrittr","tidyr","readxl","nnet")
m1<-multinom(priority~Age+Size+Frequency,data=rank_final,family=binomial(link="logit"))
summary(m1)
rank_final[-which(rank_final$Frequency=="Unknown"),]
rank_final[-which(rank_final$Frequency=="Unknown"),]->rank_final
m1<-multinom(priority~Age+Size+Frequency,data=rank_final,family=binomial(link="logit"))
summary(m1)
rank_final[-which(rank_final$Size=="Unknown"),]->rank_final
m1<-multinom(priority~Age+Size+Frequency,data=rank_final,family=binomial(link="logit"))
summary(m1)
View(haverank)
haverank<-prior_bi[which(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000"),]
norank<-prior_bi[-which(apply(prior_bi,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))!="00000000"),]
norank_1<-norank[which(norank$`Q21.1 Rate Awareness`=="Extremely important"),]
norank_1[,6:12]<-"NA"
norank_2<-norank[which(norank$`Q21.2 Rate Fam Edu`=="Extremely important"),]
norank_2[,c(5,7:12)]<-"NA"
norank_3<-norank[which(norank$`Q21.3 Rate Provider Edu`=="Extremely important"),]
norank_3[,c(5,6,8:12)]<-"NA"
norank_4<-norank[which(norank$`Q21.4 Rate Support Fam`=="Extremely important"),]
norank_4[,c(5:7,9:12)]<-"NA"
norank_5<-norank[which(norank$`Q21.5 Rate Fam Resource`=="Extremely important"),]
norank_5[,c(5:8,10:12)]<-"NA"
norank_6<-norank[which(norank$`Q21.6 Rate Research`=="Extremely important"),]
norank_6[,c(5:9,11:12)]<-"NA"
norank_7<-norank[which(norank$`Q21.7 Rate Research Policy`=="Extremely important"),]
norank_7[,c(5:10,12)]<-"NA"
norank_8<-norank[which(norank$`Q21.8 Rate Advocacy`=="Extremely important"),]
norank_8[,5:11]<-"NA"
# rbind(norank_1,norank_2,norank_3,norank_4,norank_5,norank_6,norank_7,norank_8,haverank)->rank_final
rank_final<-haverank
rank_final["bicode"]<-ifelse(apply(rank_final,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))=="00000000",apply(rank_final,1,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse="")),apply(rank_final,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse="")))
rank_final["priority"]<-apply(rank_final,1,function(x) switch(x[21],"10000000"="Awareness","01000000"="Fam Edu","00100000"="Provide Edu","00010000"="Support Fam","00001000"="Fam Resource","00000100"="Research","00000010"="Research Policy","00000001"="Advocacy"))
rank_final[-which(rank_final$Frequency=="Unknown"),]->rank_final
rank_final[-which(rank_final$Size=="Unknown"),]->rank_final
m1<-multinom(priority~Age+Size+Frequency,data=rank_final,family=binomial(link="logit"))
summary(m1)
rbind(norank_1,norank_2,norank_3,norank_4,norank_5,norank_6,norank_7,norank_8,haverank)->rank_final2
rank_final2["bicode"]<-ifelse(apply(rank_final2,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))=="00000000",apply(rank_final2,1,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse="")),apply(rank_final2,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse="")))
rank_final2["priority"]<-apply(rank_final2,1,function(x) switch(x[21],"10000000"="Awareness","01000000"="Fam Edu","00100000"="Provide Edu","00010000"="Support Fam","00001000"="Fam Resource","00000100"="Research","00000010"="Research Policy","00000001"="Advocacy"))
rank_final2[-which(rank_final2$Frequency=="Unknown"),]->rank_final2
rank_final2[-which(rank_final2$Size=="Unknown"),]->rank_final2
m1<-multinom(priority~Age+Size+Frequency,data=rank_final,family=binomial(link="logit"))
summary(m1)
m2<-multinom(priority~Age+Size+Frequency,data=rank_final2,family=binomial(link="logit"))
summary(m2)
cofint(m1)
confint(m1)
# rbind(norank_1,norank_2,norank_3,norank_4,norank_5,norank_6,norank_7,norank_8,haverank)->rank_final2
# rank_final2["bicode"]<-ifelse(apply(rank_final2,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse=""))=="00000000",apply(rank_final2,1,function(x) paste0(ifelse(x[5:12]=="Extremely important",1,0),collapse="")),apply(rank_final2,1,function(x) paste0(ifelse(x[13:20]==1,1,0),collapse="")))
# rank_final2["priority"]<-apply(rank_final2,1,function(x) switch(x[21],"10000000"="Awareness","01000000"="Fam Edu","00100000"="Provide Edu","00010000"="Support Fam","00001000"="Fam Resource","00000100"="Research","00000010"="Research Policy","00000001"="Advocacy"))
# rank_final2[-which(rank_final2$Frequency=="Unknown"),]->rank_final2
# rank_final2[-which(rank_final2$Size=="Unknown"),]->rank_final2
m1<-multinom(priority~Age+Size+Frequency,data=rank_final,family=binomial(link="logit"))
summary(m1)
# m2<-multinom(priority~Age+Size+Frequency,data=rank_final2,family=binomial(link="logit"))
# summary(m2)
plot(confint(m1))
View(haverank)
View(rank_final)
unique(rank_final$priority)
subset(rank_final,priority=="Provide Edu")
View(priority)
